<div class="relative bg-white overflow-scroll-y mx-4">
  <div class="mt-4 max-w-screen-xl mx-auto relative">
    <h3 class="mb-0 text-xl tracking-tight leading-10 font-bold text-gray-900 sm:leading-none md:mb-4 md:text-3xl">
      <a
        [routerLink]="['/documents']"
        class="rounded-md text-orange-600 hover:text-orange-900 focus:text-orange-900"
        >
        Document Explorer
      </a>
    </h3>
    <h2 class="text-xl tracking-tight leading-10 text-gray-900 sm:leading-none md:text-2xl mb-4">
      <span class="font-bold">
        Document:
      </span>
      {{ documentId }}
    </h2>
    <button
      class="mb-2 md:mb-4 md:mt-1 px-2 py-1 w-full md:w-auto mx-1 border border-transparent text-sm leading-6 font-medium rounded-md shadow
        text-white focus:outline-none focus:shadow-outline
        bg-green-600 hover:bg-green-500
        transition duration-150 ease-in-out md:text-base"
        (click)="backToList()"
      >
      <svg
        width="0.6em"
        height="0.6em"
        viewBox="0 0 256 256"
        class="inline mr-1 -mt-1 fill-current"
        ><g><g><polygon points="207.093,30.187 176.907,0 48.907,128 176.907,256 207.093,225.813 109.28,128"/></g></g>
      </svg>
      Back to Results
    </button>
    <ul class="list-reset flex">
      <li class="-mb-px mr-1">
        <a
          class="inline-block cursor-pointer border-l border-t border-r rounded-t py-2 px-4 font-semibold"
          [ngClass]="{'font-bold bg-gray-200 dark-mode:bg-materialGray-600 cursor-text': currentTab == 'metadata'}"
          (click)="changeTab('metadata')"
          >
          Metadata
        </a>
      </li>
      <li class="-mb-px mr-1">
        <a
          class="inline-block cursor-pointer border-l border-t border-r rounded-t py-2 px-4 font-semibold"
          [ngClass]="{'font-bold bg-gray-200 dark-mode:bg-materialGray-600 cursor-text': currentTab == 'tags'}"
          (click)="changeTab('tags')"
          >
          Tags
        </a>
      </li>
      <li *ngIf="showViewDocumentTab" class="-mb-px mr-1">
        <a
          class="inline-block cursor-pointer border-l border-t border-r rounded-t py-2 px-4 font-semibold"
          [ngClass]="{'font-bold bg-gray-200 dark-mode:bg-materialGray-600 cursor-text': currentTab == 'viewDocument'}"
          (click)="changeTab('viewDocument')"
          >
          View Document
        </a>
      </li>
      <li *ngIf="showFormDataTab" class="-mb-px mr-1">
        <a
          class="inline-block cursor-pointer border-l border-t border-r rounded-t py-2 px-4 font-semibold"
          [ngClass]="{'font-bold bg-gray-200 dark-mode:bg-materialGray-600 cursor-text': currentTab == 'formData'}"
          (click)="changeTab('formData')"
          >
          Form Data
        </a>
      </li>
      <li *ngIf="showJsonDataTab" class="-mb-px mr-1">
        <a
          class="inline-block cursor-pointer border-l border-t border-r rounded-t py-2 px-4 font-semibold"
          [ngClass]="{'font-bold bg-gray-200 dark-mode:bg-materialGray-600 cursor-text': currentTab == 'jsonData'}"
          (click)="changeTab('jsonData')"
          >
          JSON
        </a>
      </li>
    </ul>
    <section [hidden]="currentTab !== 'metadata'" class="border lg:w-full mb-4 md:mb-8 p-2">
      <table
        *ngIf="currentDocument"
        class="border-collapse w-full"
        >
        <tbody>
          <tr
            class="bg-white flex lg:table-row flex-row flex-wrap mb-2 "
            >
            <td class="w-full p-3 pt-8 lg:pt-2 lg:pl-48 text-gray-800 text-center lg:text-left border border-b block relative">
              <span class="absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">Content Type</span>
              <span class="font-bold">
                {{ currentDocument.contentType }}
              </span>
            </td>
          </tr>
          <tr
            class="bg-white flex lg:table-row flex-row flex-wrap mb-2 "
            >
            <td class="w-full p-3 pt-8 lg:pt-2 lg:pl-48 text-gray-800 text-center lg:text-left border border-b block relative">
              <span class="absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">Content Length</span>
              <span class="font-bold">
                {{ currentDocument.contentLength | number }} bytes
              </span>
            </td>
          </tr>
          <tr
            class="bg-white flex lg:table-row flex-row flex-wrap mb-2 "
            >
            <td class="w-full p-3 pt-8 lg:pt-2 lg:pl-48 text-gray-800 text-center lg:text-left border border-b block relative">
              <span class="absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">Checksum</span>
              <span class="font-bold">
                {{ currentDocument.checksum }} bytes
              </span>
            </td>
          </tr>
          <tr
            class="bg-white flex lg:table-row flex-row flex-wrap mb-2 "
            >
            <td class="w-full p-3 pt-8 lg:pt-2 lg:pl-48 text-gray-800 text-center lg:text-left border border-b block relative">
              <span class="absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">Document Path</span>
              <span class="font-bold">
                {{ currentDocument.path }}
              </span>
            </td>
          </tr>
          <tr
            class="bg-white flex lg:table-row flex-row flex-wrap mb-2 "
            >
            <td class="w-full p-3 pt-8 lg:pt-2 lg:pl-48 text-gray-800 text-center lg:text-left border border-b block relative">
              <span class="absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">Added By</span>
              <span class="font-bold">
                {{ currentDocument.userId }}
              </span>
            </td>
          </tr>
          <tr
            class="bg-white flex lg:table-row flex-row flex-wrap mb-2 "
            >
            <td class="w-full p-3 pt-8 lg:pt-2 lg:pl-48 text-gray-800 text-center lg:text-left border border-b block relative">
              <span class="absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">Date Added</span>
              <span class="font-bold">
                {{ currentDocument.insertedDate | datetimeFormat: 'yyyy-MM-dd HH:mm Z':currentTimezone }}
              </span>
            </td>
          </tr>
          <tr
            class="bg-white flex lg:table-row flex-row flex-wrap mb-2 "
            >
            <td class="w-full p-3 pt-8 lg:pt-2 lg:pl-48 text-gray-800 text-center lg:text-left border border-b block relative">
              <span class="absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">Site Group</span>
              <span class="font-bold">
                {{ currentDocument.siteId }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
    <section *ngIf="showViewDocumentTab" [hidden]="currentTab !== 'viewDocument'" class="border lg:w-full mb-4 md:mb-8 p-2">
      <iframe
        [hidden]="!quickLookExpanded"
        id="documentFrame"
        class="border w-full"
        ></iframe>
    </section>
    <section [hidden]="currentTab !== 'tags'" class="border lg:w-full mb-4 md:mb-8 p-2">
      <div *ngIf="results$ | async as results" class="text-center">
        <app-paging [results]="results" (previousEmitter)="loadPreviousPage()" (nextEmitter)="loadNextPage()"></app-paging>
      </div>
      <table
        *ngIf="results$ | async as results"
        class="border-collapse w-full"
        >
        <thead>
          <tr>
            <th class="p-3 font-bold uppercase bg-gray-200 text-gray-900 border border-gray-300 hidden lg:table-cell">
              Key
            </th>
            <th class="p-3 font-bold uppercase bg-gray-200 text-gray-900 border border-gray-300 hidden lg:table-cell">
              Value
            </th>
            <th class="p-3 font-bold uppercase bg-gray-200 text-gray-900 border border-gray-300 hidden lg:table-cell">
              Date Added
            </th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngIf="!results.tags.length"
            class="bg-gray-100 flex text-center py-2 px-1 lg:table-row flex-row lg:flex-row flex-wrap lg:flex-no-wrap mb-10 lg:mb-0"
            >
            <td
              colspan="100%"
              >
              No tags have been found for this document.
            </td>
          </tr>
          <tr
            *ngFor="let tag of results.tags"
            class="bg-white lg:hover:bg-gray-100 flex lg:table-row flex-row lg:flex-row flex-wrap lg:flex-no-wrap mb-10 lg:mb-0"
            >
            <td class="w-full lg:w-auto p-3 pt-8 lg:pt-3 text-gray-800 text-center border border-b block lg:table-cell relative lg:static">
              <span class="lg:hidden absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">Key</span>
              {{ tag.key }}
              <span *ngIf="tag.type === 'systemdefined'" class="block text-sm tracking-tight">(read-only)</span>
              <div>
                <button
                  *ngIf="f.tagKey.value != tag.key && tag.type !== 'systemdefined'"
                  class="mt-1 px-2 py-1 w-full md:w-auto mx-1 border border-transparent text-sm leading-6 font-medium rounded-md shadow
                    text-white focus:outline-none focus:shadow-outline
                    bg-green-600 hover:bg-green-500
                    transition duration-150 ease-in-out md:text-base"
                  (click)="editTag(tag.key, tag.value)"
                  >
                  Edit
                </button>
                <button
                  *ngIf="f.tagKey.value != tag.key && tag.type !== 'systemdefined'"
                  class="mt-1 px-2 py-1 w-full md:w-auto mx-1 border border-transparent text-sm leading-6 font-medium rounded-md shadow
                    text-white focus:outline-none focus:shadow-outline
                    bg-green-600 hover:bg-green-500
                    transition duration-150 ease-in-out md:text-base"
                  (click)="deleteTag(tag.key)"
                  >
                  Delete
                </button>
                <button
                  *ngIf="f.tagKey.value == tag.key"
                  class="mt-1 px-2 py-1 w-full md:w-auto mx-1 border border-transparent text-sm leading-6 font-medium rounded-md shadow
                    text-white focus:outline-none focus:shadow-outline
                    bg-green-600 hover:bg-green-500
                    transition duration-150 ease-in-out md:text-base"
                  (click)="cancelEdit()"
                  >
                  Cancel Edit
                </button>
              </div>
            </td>
            <td class="w-full lg:w-auto p-3 pt-8 lg:pt-3  text-gray-800 text-center border border-b text-center block lg:table-cell relative lg:static">
              <span class="lg:hidden absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">Value</span>
              {{ tag.value }}
            </td>
            <td class="w-full lg:w-auto p-3 pt-8 lg:pt-3 text-gray-800 text-center border border-b text-center block lg:table-cell relative lg:static">
              <span class="lg:hidden absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">Date Added</span>
              {{ tag.insertedDate | datetimeFormat: 'yyyy-MM-dd HH:mm Z':currentTimezone }}
            </td>
          </tr>
        </tbody>
      </table>
      <div *ngIf="results$ | async as results" class="text-center">
        <app-paging [results]="results" (previousEmitter)="loadPreviousPage()" (nextEmitter)="loadNextPage()"></app-paging>
      </div>
      <form [formGroup]="form" (ngSubmit)="saveTag()">
        <h6
          id="formHeader"
          class="mx-4 md:mx-6 mr-4 mt-6 mb-2 md:mb-8 text-xl tracking-tight leading-10 font-bold text-orange-600 sm:leading-none md:text-2xl"
          >
          <span *ngIf="isTagEditMode">
            Edit
          </span>
          <span *ngIf="!isTagEditMode">
            New
          </span>
          Tag
        </h6>
        <div class="md:flex md:items-center mx-4 mb-4 relative">
          <div class="md:w-1/6">
            <label class="block text-gray-500 font-bold md:text-right mb-1 md:mb-0 pr-4" for="tagKey">
              Key
            </label>
          </div>
          <div class="md:w-1/3">
            <input
              aria-label="Key"
              name="tagKey"
              formControlName="tagKey"
              type="text"
              class="appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-600
                placeholder-gray-500 text-gray-900 rounded-t-md
                focus:outline-none focus:shadow-outline-blue focus:border-blue-300 focus:z-10 sm:text-xl sm:leading-5"
              [ngClass]="{ 'bg-red-200': this.formSubmitted && this.form.controls.tagKey.errors }"
              />
          </div>
          <div class="md:w-1/6">
            <label class="block text-gray-500 font-bold md:text-right mb-1 md:mb-0 pr-4" for="tagValue">
              Value
            </label>
          </div>
          <div class="md:w-1/3">
            <input
              aria-label="Value"
              name="tagValue"
              formControlName="tagValue"
              type="text"
              class="appearance-none rounded-md relative block w-full px-3 py-3 border border-gray-600
                placeholder-gray-500 text-gray-900 rounded-t-md
                focus:outline-none focus:shadow-outline-blue focus:border-blue-300 focus:z-10 sm:text-xl sm:leading-5"
              [ngClass]="{ 'bg-red-200': this.formSubmitted && this.form.controls.tagValue.errors }"
              />
          </div>
        </div>
        <div class="md:flex md:items-center mx-4 mb-4 relative">
          <div class="md:w-1/6">
          </div>
          <div class="md:w-5/6">
            <button
              (click)="saveTag()"
              [disabled]="this.form.invalid"
              class="px-2 md:px-8 py-3 mx-1 border border-transparent text-base leading-6 font-medium rounded-md shadow
                text-white focus:outline-none focus:shadow-outline
                transition duration-150 ease-in-out md:py-4 md:text-lg md:px-10"
              [ngClass]="{
                  'bg-green-600 hover:bg-green-500': !this.form.invalid,
                  'bg-gray-500 hover:bg-gray-500': this.form.invalid
                }"
              >
                <span *ngIf="isTagEditMode">
                  Save
                </span>
                <span *ngIf="!isTagEditMode">
                  Add
                </span>
            </button>
            <button
              *ngIf="isTagEditMode"
              (click)="cancelEdit()"
              class="px-2 md:px-8 py-3 mx-1 border border-transparent text-base leading-6 font-medium rounded-md shadow
                text-white focus:outline-none focus:shadow-outline
                bg-green-600 hover:bg-green-500
                transition duration-150 ease-in-out md:py-4 md:text-lg md:px-10"
              >
                Cancel
            </button>
          </div>
        </div>
      </form>
    </section>
    <section *ngIf="showFormDataTab && currentDocument.content" [hidden]="currentTab !== 'formData'" class="border lg:w-full mb-4 md:mb-8 p-2">
      <h4
        class="mx-4 md:mx-6 mr-4 mt-6 mb-2 text-xl tracking-tight leading-10 font-bold sm:leading-none md:text-2xl"
        >
        {{ currentDocument.content.formName }}
      </h4>
      <h6
        class="mx-4 md:mx-6 mr-4 mb-2 md:mb-8 text-base tracking-tight leading-10 font-bold sm:leading-none"
        >
        {{ currentDocument.path }}
      </h6>
      <table
        class="border-collapse w-full"
        >
        <tbody>
          <tr
            *ngIf="!currentDocument.content.formFields.length"
            class="bg-gray-100 flex text-center py-2 px-1 lg:table-row flex-row lg:flex-row flex-wrap lg:flex-no-wrap mb-10 lg:mb-0"
            >
            <td
              colspan="100%"
              >
              No form fields were submitted as part of this web form.
            </td>
          </tr>
          <tr
            *ngFor="let field of currentDocument.content.formFields"
            class="bg-white flex lg:table-row flex-row flex-wrap mb-2 "
            >
            <td class="w-full p-3 pt-8 lg:pt-2 lg:pl-48 text-gray-800 text-center lg:text-left border border-b block relative">
              <span class="absolute top-0 left-0 bg-gray-200 px-2 py-1 text-xs font-bold uppercase">{{ field.fieldName }}</span>
              <span class="font-bold">
                {{ field.value }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
      <h5
        class="mx-4 md:mx-6 mr-4 mt-6 mb-2 text-lg tracking-tight leading-10 font-bold sm:leading-none md:text-xl"
        >
        Attachments
        <small class="text-sm">
          (to be added)
        </small>
      </h5>
    </section>
    <section [hidden]="currentTab !== 'jsonData'" class="border lg:w-full mb-4 md:mb-8 p-2">
      <div id="jsonContainer"></div>
    </section>
  </div>
</div>
