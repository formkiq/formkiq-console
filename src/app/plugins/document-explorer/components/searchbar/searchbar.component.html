
<div class="row">
  <div class="col-12 my-2">
    <h5 class="formkiq-font collapse-link"
      (click)="navigationService.collapseSubmenuItem('documentSearchClicked', !isCollapsed);">
      <fa *ngIf="isCollapsed" name="chevron-right"></fa>
      <fa *ngIf="!isCollapsed" name="chevron-down"></fa>
      Document Search
    </h5>
  </div>
  <div class="row">
    <div class="col-12 px-4 mb-2">
      <form [formGroup]="dateSearchForm">
        <div class="row mb-4">
          <div class="col-12 col-md-2">
            <label for="dp" class="pl-2 pt-1">
              <h5>
                By Date
              </h5>
            </label>
          </div>
          <div class="col-6 col-md-6">
            <div class="input-group">
              <input
                class="form-control"
                placeholder="yyyy-mm-dd"
                name="dp"
                ngbDatepicker #d="ngbDatepicker" (dateSelect)="onDateSelected($event)">
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" (click)="d.toggle()" type="button"><i class="fa fa-calendar"></i></button>
              </div>
            </div>
          </div>
          <div class="col-6 col-md-3">
            <input type="button" class="btn btn-primary" value="Today" (click)="viewTodaysDocuments()" />
          </div>
        </div>
      </form>
      <form [formGroup]="tagSearchForm" (ngSubmit)="runTagSearch()">
        <div class="row mb-2">
          <div class="col-12 col-md-2">
            <label class="pl-2 pt-1">
              <h5>
                By Tag
              </h5>
            </label>
          </div>
          <div class="col-12 col-md-3 col-lg-2 pb-1">
            <input type="text" class="form-control" formControlName="tagKey" placeholder="key name" [ngClass]="{ 'is-invalid': submitted && f.tagKey.errors }" />
          </div>
          <div class="col-12 col-md-3 col-lg-2 pb-1">
            <select class="form-control mr-sm-2" formControlName="searchType">
              <option value="eq">Equals</option>
              <option value="beginsWith">Begins With</option>
            </select>
          </div>
          <div class="col-12 col-md-3 col-xl-4 pb-1">
            <input type="text" class="form-control" formControlName="tagValue" placeholder="tag value">
          </div>
          <div class="offset-0 offset-md-2 offset-lg-0 col-6 col-md-12 col-lg-2">
            <input type="button" class="btn btn-primary mr-2" value="Run Tag Search" (click)="runTagSearch()" />
          </div>
        </div>
        <div class="row">
          <div class="col-12 text-center pt-2">
            <input type="button" class="btn btn-primary" value="View All Untagged Documents" (click)="viewAllUntaggedDocuments()" />

          </div>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="mt-2">
  <div class="table">
    <table class="table table-hover">
      <thead>
        <tr>
          <th scope="col">Document</th>
          <th scope="col">Path</th>
          <th scope="col">Date Inserted</th>
          <th scope="col">&nbsp;</th>
        </tr>
      </thead>
      <tbody *ngIf="results$ | async as results else divForSubmitQuerySpinner">
        <tr *ngIf="results.documents.length == 0"><td>No Documents Found</td></tr>
        <tr *ngFor="let result of results.documents">
          <td>{{result.documentId}}</td>
          <td>{{result.path}}&nbsp;</td>
          <td>{{result.inserteddate}}&nbsp;</td>
          <td><input type="button" value="Tags..." (click)="viewDocumentTags(result.documentId)" /></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<ng-template #divForSubmitQuerySpinner>
  <div class="wrapper divForSpinner" *ngIf="submitted && !submittedCompleted && !this.tagSearchForm.invalid">
    <div class="overlay">
      <div class="spinner-wrapper">
        <app-spinner></app-spinner>
      </div>
    </div>

    <ng-content></ng-content>
  </div>
</ng-template>
